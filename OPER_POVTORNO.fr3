<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.8.27" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41807,5617643056" ReportOptions.Description.Text="" ReportOptions.LastChange="41926,6063061921" ScriptLanguage="PascalScript" ScriptText.Text="procedure fMainOnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dtBegin.Date := EncodeDate(YearOf(now),MonthOf(now),1);&#13;&#10;  dtEnd.Date := EncodeDate(YearOf(now),MonthOf(now),DaysInMonth(YearOf(now),MonthOf(now)));&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure btSubOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btAddOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;  &#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;Var S : String;&#13;&#10;      &#13;&#10;begin&#13;&#10;  S := 'за период с ' + DateToStr(dtBegin.Date)+ ' по ' + DateToStr(dtEnd.Date);&#13;&#10;  Set('PeriodName', '''' + S + '''');&#13;&#10;          &#13;&#10;  dsLPU.Close;&#13;&#10;  dsLPU.ParamByName('kodbol').Value := StrToInt(VarIdLPU);&#13;&#10;  dsLPU.Open;          &#13;&#10;  Set('NameMO', '''' + dsLPU.FieldByName('st_bol_name').AsString + '''');&#13;&#10;  dsLPU.Close;&#13;&#10;    &#13;&#10;  dsData.Close;                  &#13;&#10;  dsData.ParamByName('dtStart').Value    := DateToStr(dtBegin.Date);            &#13;&#10;  dsData.ParamByName('dtStop').Value     := DateToStr(dtEnd.Date);&#13;&#10;  dsData.ParamByName('LPU_ID').Value     := StrToInt(VarIdLPU);&#13;&#10;  dsData.Open;&#13;&#10;    &#13;&#10;  if dsData.RecordCount = 0 then                                   &#13;&#10;    begin                                                            &#13;&#10;      ShowMessage('Нет данных согласно выбранным условиям!');                                                          &#13;&#10;    end                                                                   &#13;&#10;  else                                                                    &#13;&#10;    begin                                                                 &#13;&#10;      Button1.ModalResult := mrOk;                                                                                &#13;&#10;      fMain.modalresult   := mrOk;                                            &#13;&#10;    end;                                                                                &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" OnReportPrint="frxReportOnReportPrint" PropData="044C656674021003546F7002100844617461736574730101062620446174615365743D226473446174612220446174615365744E616D653D22647344617461220001062420446174615365743D2264734C50552220446174615365744E616D653D2264734C5055220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Font.Charset="1" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxFIBQuery Name="dsData" UserName="dsData" CloseDataSource="True" FieldAliases.Text="NAIMOTD=NAIMOTD&#13;&#10;NUMCARD=NUMCARD&#13;&#10;PATIENT_FIO=PATIENT_FIO&#13;&#10;DT_RECEIPT=DT_RECEIPT&#13;&#10;DTEXTRACT=DTEXTRACT&#13;&#10;SRV_ID_FK=SRV_ID_FK&#13;&#10;SRV_NAME=SRV_NAME&#13;&#10;KODXIOP=KODXIOP&#13;&#10;NAIMXIOP=NAIMXIOP&#13;&#10;OPKOD=OPKOD&#13;&#10;OPNAME=OPNAME&#13;&#10;DTOPER=DTOPER&#13;&#10;TMOPER=TMOPER" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;       pat.NAIMOTD,                         &#13;&#10;       pat.NUMCARD,  &#13;&#10;       pat.PATIENT_FIO,                                 &#13;&#10;       pat.DT_RECEIPT,  &#13;&#10;       pat.DTEXTRACT,&#13;&#10;       op.SRV_ID_FK,  &#13;&#10;       op.SRV_NAME,&#13;&#10;       op.KODXIOP,  &#13;&#10;       op.NAIMXIOP,&#13;&#10;       op.DTOPER,  &#13;&#10;       op.TMOPER                                &#13;&#10;FROM&#13;&#10;   VW_WT_SURGICAL_OPERATION as op            &#13;&#10;INNER JOIN                       &#13;&#10;   VW_PATIENT_SMALL as pat    &#13;&#10;ON op.WT_PATIENT_ID_FK = pat.WT_PATIENT_ID                         &#13;&#10;WHERE pat.DTEXTRACT BETWEEN :dtStart AND :dtStop                                                     &#13;&#10;  AND pat.ID_LPU_FK = :LPU_ID                          &#13;&#10;  AND 1 &#60;               &#13;&#10;         (&#13;&#10;          SELECT COUNT(*) FROM&#13;&#10;               (&#13;&#10;                SELECT DISTINCT DTOPER&#13;&#10;                FROM VW_WT_SURGICAL_OPERATION&#13;&#10;                WHERE WT_PATIENT_ID_FK = op.WT_PATIENT_ID_FK&#13;&#10;                AND SRV_ID_FK &#62; ''                                                              &#13;&#10;               )&#13;&#10;          )              &#13;&#10;ORDER BY pat.NAIMOTD, pat.NUMCARD, pat.DT_RECEIPT, op.DTOPER&#13;&#10;  &#13;&#10;            &#13;&#10;          " PropData="05704C656674039C000470546F70026C0A506172616D657465727301010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D22647453746F70222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D224C50555F4944222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxFIBQuery Name="dsLPU" UserName="dsLPU" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="Select St_bol_name, OGRN From VW_ST_BOL&#13;&#10;Where kodbol=:kodbol                                             " PropData="05704C656674023C0470546F70026C0A506172616D657465727301010622204E616D653D226B6F64626F6C222044617461547970653D226674537472696E67220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="184" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="dsData" DataSetName="dsData" RowCount="0">
      <TfrxMemoView Name="dsDataKODXIOP" Left="404,40971" Top="0" Width="83,14966" Height="18,89765" ShowHint="False" DataField="KODXIOP" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[dsData.&#34;KODXIOP&#34;]"/>
      <TfrxMemoView Name="dsDataNAIMXIOP" Left="487,55937" Top="0" Width="385,51206" Height="18,89765" ShowHint="False" DataField="NAIMXIOP" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[dsData.&#34;NAIMXIOP&#34;]"/>
      <TfrxMemoView Name="dsDataSRV_NAME" Left="487,55937" Top="0" Width="385,51206" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" WordWrap="False" Text="[dsData.&#34;SRV_NAME&#34;]"/>
      <TfrxMemoView Name="dsDataDTOPER" Left="873,07143" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[dsData.&#34;DTOPER&#34;]"/>
      <TfrxMemoView Name="dsDataNUMCARD" Left="0" Top="0" Width="41,57483" Height="18,89765" ShowHint="False" DataField="NUMCARD" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" SuppressRepeated="True" WordWrap="False" Text="[dsData.&#34;NUMCARD&#34;]"/>
      <TfrxMemoView Name="dsDataFIO" Left="41,57483" Top="0" Width="234,33086" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" SuppressRepeated="True" WordWrap="False" Text="[dsData.&#34;PATIENT_FIO&#34;]"/>
      <TfrxMemoView Name="dsDataDT_RECEIPT" Left="275,90569" Top="0" Width="128,50402" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" SuppressRepeated="True" Text="[dsData.&#34;DT_RECEIPT&#34;]   [dsData.&#34;DTEXTRACT&#34;]"/>
      <TfrxMemoView Name="dsDataSRV_ID_FK" Left="404,40971" Top="0" Width="83,14966" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[dsData.&#34;SRV_ID_FK&#34;]"/>
      <TfrxMemoView Name="dsDataTMOPER" Left="944,8825" Top="0" Width="56,69295" Height="18,89765" ShowHint="False" DataField="TMOPER" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[dsData.&#34;TMOPER&#34;]"/>
      <TfrxMemoView Name="Memo14" Left="340,1577" Top="0" Width="64,25201" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="222" Width="1046,92981">
      <TfrxMemoView Name="Memo11" Left="687,87446" Top="0" Width="355,27582" Height="18,89765" ShowHint="False" HAlign="haRight" Text="Дата и время составления отчета [Date] [Time]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" Height="147,40167" Left="0" Top="16" Width="1046,92981" Condition="dsData.&#34;NAIMOTD&#34;" KeepTogether="True" StartNewPage="True">
      <TfrxMemoView Name="dsDataNAIMOTD" Left="79,37013" Top="94,48825" Width="423,30736" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[dsData.&#34;NAIMOTD&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="0" Top="117,16543" Width="41,57483" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№Карты"/>
      <TfrxMemoView Name="Memo3" Left="41,57483" Top="117,16543" Width="234,33086" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ФИО Пациента"/>
      <TfrxMemoView Name="Memo4" Left="275,90569" Top="117,16543" Width="64,25201" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дата поступ"/>
      <TfrxMemoView Name="Memo5" Left="340,1577" Top="117,16543" Width="64,25201" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дата выбыт"/>
      <TfrxMemoView Name="Memo6" Left="487,55937" Top="117,16543" Width="385,51206" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Наименование операции"/>
      <TfrxMemoView Name="Memo7" Left="873,07143" Top="117,16543" Width="71,81107" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дата операции"/>
      <TfrxMemoView Name="Memo9" Left="404,40971" Top="117,16543" Width="83,14966" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Код операции"/>
      <TfrxMemoView Name="Memo12" Left="944,8825" Top="117,16543" Width="56,69295" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Время операции"/>
      <TfrxMemoView Name="Memo8" Left="0" Top="30,23624" Width="1046,92981" Height="26,45671" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ОПЕРАЦИИ, ПРОВЕДЁННЫЕ ДЛЯ ОДНОГО БОЛЬНОГО В РАЗНЫЕ ДНИ"/>
      <TfrxMemoView Name="Memo10" Left="11,33859" Top="0" Width="971,33921" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[NameMO]"/>
      <TfrxMemoView Name="Memo1" Left="525,35467" Top="94,48825" Width="483,77984" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Какие из них - не запланированные возвраты в операционную?"/>
      <TfrxMemoView Name="Memo13" Left="302,3624" Top="56,69295" Width="415,7483" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" WordWrap="False" Text="[PeriodName]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="fMain" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="168" ClientHeight="140" Left="506" Top="216" Width="324" ClientWidth="316" OnActivate="fMainOnActivate">
    <TfrxLabelControl Name="Label2" Left="10" Top="6" Width="153" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Период формирования отчёта" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="56" Top="102" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Ок" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="162" Top="102" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" ModalResult="2" OnClick="Button2OnClick"/>
    <TfrxLabelControl Name="Label1" Left="18" Top="34" Width="82" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Начало периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtBegin" Left="162" Top="28" Width="91" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40820,4585511227" Time="40820,4585511227"/>
    <TfrxLabelControl Name="Label3" Left="18" Top="62" Width="100" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Окончание периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtEnd" Left="162" Top="56" Width="91" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40820,4594548264" Time="40820,4594548264"/>
    <TfrxButtonControl Name="btSub" Left="258" Top="28" Width="23" Height="25" ShowHint="True" Caption="&#60;" OnClick="btSubOnClick"/>
    <TfrxButtonControl Name="btAdd" Left="280" Top="28" Width="23" Height="25" ShowHint="True" Caption="&#62;" OnClick="btAddOnClick"/>
  </TfrxDialogPage>
</TfrxReport>
