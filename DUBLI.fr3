<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.8.27" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40720,5875882407" ReportOptions.Description.Text="" ReportOptions.LastChange="42083,5547785532" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;   KodOtd            : integer;&#13;&#10;   KOD_NUM           : integer;                                        // BDC 30.08.2013                                                                                                                                                                                                                                               &#13;&#10;  &#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;Var&#13;&#10;S : String;&#13;&#10;begin&#13;&#10;  S := 'за период';&#13;&#10;  S := S + ' с ' + DateToStr(dtBegin.Date);        &#13;&#10;  S := S + ' по ' + DateToStr(dtEnd.Date);&#13;&#10;  Set('PeriodName', '''' + S + '''');&#13;&#10;  dsLPU.Close;&#13;&#10;  dsLPU.ParamByName('kodbol').Value := StrToInt(VarIdLPU);&#13;&#10;  dsLPU.Open;          &#13;&#10;  Set('NameMO', '''' + dsLPU.FieldByName('st_bol_name').AsString + '''');&#13;&#10;  dsLPU.Close;&#13;&#10;&#13;&#10;  dsDataNew.Close;&#13;&#10;  dsDataNew.ParamByName('dtStart').Value    := DateToStr(dtBegin.Date);            &#13;&#10;  dsDataNew.ParamByName('dtStop').Value     := DateToStr(dtEnd.Date);&#13;&#10;  dsDataNew.ParamByName('lpu_id').Value     := StrToInt(VarIdLPU);&#13;&#10;  &#13;&#10;  dsDataOld.Close;&#13;&#10;  dsDataOld.ParamByName('dtStart').Value    := DateToStr(dtBegin.Date);            &#13;&#10;  dsDataOld.ParamByName('dtStop').Value     := DateToStr(dtEnd.Date);&#13;&#10;  dsDataOld.ParamByName('lpu_id').Value     := StrToInt(VarIdLPU);&#13;&#10;         &#13;&#10;  Button1.ModalResult := mrOk;                                                                                &#13;&#10;  fMain.modalresult   := mrOk;  &#13;&#10;          {                    &#13;&#10;       &#13;&#10;  if dsData.RecordCount = 0 then                                   &#13;&#10;    begin                                                            &#13;&#10;      ShowMessage('Нет данных согласно выбранным условиям!');                                                          &#13;&#10;    end                                                                   &#13;&#10;  else                                                                    &#13;&#10;    begin                                                                 &#13;&#10;      Button1.ModalResult := mrOk;                                                                                &#13;&#10;      fMain.modalresult   := mrOk;                                            &#13;&#10;    end;   }                                                                                  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure fMainOnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dtBegin.Date := EncodeDate(YearOf(now), 1, 1);&#13;&#10;  dtEnd.Date := EncodeDate(YearOf(now), MonthOf(now), DaysInMonth(YearOf(now),MonthOf(now)));                                                                                                                                                                                                                                                                                                          &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure btSubOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btAddOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;      &#13;&#10;begin&#13;&#10;&#13;&#10;end.&#13;&#10;    " StoreInDFM="False" OnReportPrint="frxReportOnReportPrint" PropData="044C656674021003546F7002100844617461736574730101062C20446174615365743D226473446174614E65772220446174615365744E616D653D226473446174614E6577220001062420446174615365743D2264734C50552220446174615365744E616D653D2264734C5055220001062C20446174615365743D226473446174614F6C642220446174615365744E616D653D226473446174614F6C64220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxFIBQuery Name="dsDataNew" UserName="dsDataNew" CloseDataSource="True" FieldAliases.Text="NUMCARD=NUMCARD" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="&#13;&#10;  SELECT NUMCARD                                    &#13;&#10;  FROM VW_PATIENT_CARD&#13;&#10;  WHERE DTEXTRACT BETWEEN :dtStart AND :dtStop  &#13;&#10;  AND (KOD_NUM = 90 OR&#13;&#10;       KOD_NUM = 300 OR &#13;&#10;       KOD_NUM = 1990 OR &#13;&#10;       KOD_NUM = 21 OR &#13;&#10;       KOD_NUM = 30 OR &#13;&#10;       KOD_NUM = 770)           &#13;&#10;  AND ID_LPU_FK = :lpu_id          &#13;&#10;  GROUP BY NUMCARD&#13;&#10;  HAVING count(*) &#62; 1  &#13;&#10;  ORDER BY NUMCARD                                                         " PropData="05704C6566740380000470546F7002700A506172616D657465727301010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D22647453746F70222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D226C70755F6964222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxFIBQuery Name="dsLPU" UserName="dsLPU" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="Select St_bol_name, OGRN From VW_ST_BOL&#13;&#10;Where kodbol=:kodbol                                             " PropData="05704C65667402240470546F7002700A506172616D657465727301010622204E616D653D226B6F64626F6C222044617461547970653D226674537472696E67220000"/>
    <TfrxFIBQuery Name="dsDataOld" UserName="dsDataOld" CloseDataSource="True" FieldAliases.Text="NUMCARD=NUMCARD" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="    &#13;&#10;  select NUMCARD                                    &#13;&#10;  from VW_PATIENT_CARD&#13;&#10;  WHERE (DTEXTRACT BETWEEN :dtStart AND :dtStop)  &#13;&#10;  AND (KOD_NUM = 40 OR &#13;&#10;       KOD_NUM = 390 OR &#13;&#10;       KOD_NUM = 310 OR &#13;&#10;       KOD_NUM = 320 OR &#13;&#10;       KOD_NUM = 22 OR &#13;&#10;       KOD_NUM = 220)           &#13;&#10;  AND ID_LPU_FK = :lpu_id          &#13;&#10;  GROUP BY NUMCARD&#13;&#10;  HAVING count(*) &#62; 1  &#13;&#10;  ORDER BY NUMCARD     " PropData="05704C65667403EA000470546F7002700A506172616D657465727301010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D22647453746F70222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D226C70755F6964222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="214" Width="718,1107">
      <TfrxMemoView Name="Memo120" Left="238,11039" Top="0" Width="102,04731" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="Стр. [Page#] из [TotalPages#]"/>
      <TfrxMemoView Name="Memo121" Left="396,85065" Top="0" Width="321,26005" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Дата и время составления отчета [Date] [Time]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="md" Height="18,89765" Left="0" Top="66" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="dsDataNew" DataSetName="dsDataNew" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo54" Left="0" Top="0" Width="37,79523898" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsDataNew" DataSetName="dsDataNew" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haCenter" ParentFont="False" Text="[Line]"/>
      <TfrxMemoView Name="dsDataNUMCARD" Left="37,7953" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataField="NUMCARD" DataSet="dsDataNew" DataSetName="dsDataNew" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[dsDataNew.&#34;NUMCARD&#34;]"/>
    </TfrxMasterData>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="176" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="dsDataOld" DataSetName="dsDataOld" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="37,79523898" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsDataNew" DataSetName="dsDataNew" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haCenter" ParentFont="False" Text="[Line]"/>
      <TfrxMemoView Name="Memo2" Left="37,7953" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataSet="dsDataNew" DataSetName="dsDataNew" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[dsDataOld.&#34;NUMCARD&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" Height="30,23621559" Left="0" Top="16" Width="718,1107">
      <TfrxMemoView Name="Memo4" Left="0" Top="0" Width="37,79526339" Height="30,23621559" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№&#13;&#10;п/п"/>
      <TfrxMemoView Name="Memo5" Left="37,7953" Top="2,44100000000025E-5" Width="71,81102362" Height="30,23619118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="№ истории болезни"/>
      <TfrxMemoView Name="Memo9" Left="109,60637" Top="0" Width="385,51206" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дублированные номера в НОВОМ КОРПУСЕ"/>
    </TfrxHeader>
    <TfrxHeader Name="Header2" Height="52,91339559" Left="0" Top="104" Width="718,1107">
      <TfrxMemoView Name="Memo6" Left="0" Top="22,67718" Width="37,79526339" Height="30,23621559" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№&#13;&#10;п/п"/>
      <TfrxMemoView Name="Memo7" Left="37,7953" Top="22,67720441" Width="71,81102362" Height="30,23619118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="№ истории болезни"/>
      <TfrxMemoView Name="Memo8" Left="109,60637" Top="22,67718" Width="385,51206" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дублированные номера в СТАРОМ КОРПУСЕ"/>
    </TfrxHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="fMain" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="179" ClientHeight="151" Left="466" Top="180" Width="355" ClientWidth="347" OnActivate="fMainOnActivate">
    <TfrxLabelControl Name="Label2" Left="12" Top="12" Width="153" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Период формирования отчёта" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="112" Top="112" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Ок" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="218" Top="112" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="24" Top="40" Width="82" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Начало периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtBegin" Left="140" Top="36" Width="85" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40820,4585511227" Time="40820,4585511227"/>
    <TfrxLabelControl Name="Label3" Left="24" Top="68" Width="100" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Окончание периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtEnd" Left="140" Top="64" Width="85" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40820,4594548264" Time="40820,4594548264"/>
    <TfrxButtonControl Name="btSub" Left="244" Top="36" Width="23" Height="25" ShowHint="True" Caption="&#60;" OnClick="btSubOnClick"/>
    <TfrxButtonControl Name="btAdd" Left="268" Top="36" Width="23" Height="25" ShowHint="True" Caption="&#62;" OnClick="btAddOnClick"/>
  </TfrxDialogPage>
</TfrxReport>
