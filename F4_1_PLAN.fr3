<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.8.27" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40720,5875882407" ReportOptions.Description.Text="" ReportOptions.LastChange="41981,6553815393" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;Var&#13;&#10;S : String;&#13;&#10;var Year, Month, Day: Word;      &#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date, Year, Month, Day);    &#13;&#10;  &#13;&#10;  S := 'за период';&#13;&#10;  S := S + ' с ' + DateToStr(dtBegin.Date);        &#13;&#10;  S := S + ' по ' + DateToStr(dtEnd.Date);&#13;&#10;  Set('PeriodName', '''' + S + '''');&#13;&#10;  &#13;&#10;  dsLPU.Close;&#13;&#10;  dsLPU.ParamByName('kodbol').Value := StrToInt(VarIdLPU);&#13;&#10;                                  &#13;&#10;  dsLPU.Open;          &#13;&#10;  Set('NameMO', '''' + dsLPU.FieldByName('st_bol_name').AsString + '''');&#13;&#10;  dsLPU.Close;&#13;&#10;  dsData.Close;&#13;&#10;  dsData.ParamByName('dtStart').Value    := DateToStr(dtBegin.Date);            &#13;&#10;  dsData.ParamByName('dtStop').Value     := DateToStr(dtEnd.Date);&#13;&#10;  dsData.ParamByName('LPU_ID').Value     := StrToInt(VarIdLPU);&#13;&#10;  //dsData.ParamByName('ye').Value     := Year;&#13;&#10;  //dsData.ParamByName('mo').Value     := Month;&#13;&#10;  dsData.ParamByName('kodbol').Value := StrToInt(VarIdLPU);      &#13;&#10;&#13;&#10;  if CheckBox1.Checked then&#13;&#10;    dsData.ParamByName('ALL_LPU').Value  := 1&#13;&#10;  else&#13;&#10;    dsData.ParamByName('ALL_LPU').Value  := 0;     &#13;&#10;  dsData.Open;                       &#13;&#10;  if dsData.RecordCount = 0 then                                   &#13;&#10;    begin                                                            &#13;&#10;      ShowMessage('Нет данных согласно выбранным условиям!');                                                          &#13;&#10;    end                                                                   &#13;&#10;  else                                                                    &#13;&#10;    begin                                                                 &#13;&#10;      Button1.ModalResult := mrOk;                                                                                &#13;&#10;      fMain.modalresult   := mrOk;                                            &#13;&#10;    end;                                                                                &#13;&#10;end;&#13;&#10;&#13;&#10;procedure fMainOnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dtBegin.Date := EncodeDate(YearOf(now),MonthOf(now),1);&#13;&#10;  dtEnd.Date := EncodeDate(YearOf(now),MonthOf(now),DaysInMonth(YearOf(now),MonthOf(now)));&#13;&#10;end;&#13;&#10;&#13;&#10;procedure mdOnBeforePrint(Sender: TfrxComponent);         &#13;&#10;var a:array[0..9, 1..12] of integer;&#13;&#10;    b:array[1..9] of integer;                                                      &#13;&#10;    m,sum:integer;                               &#13;&#10;begin&#13;&#10;a[5,1]:=82;	a[5,2]:=107;	a[5,3]:=107;	a[5,4]:=107;	a[5,5]:=107;	a[5,6]:=107;	a[5,7]:=107;	a[5,8]:=105;	a[5,9]:=0;	a[5,10]:=0;	a[5,11]:=0;	a[5,12]:=2;&#13;&#10;a[1,1]:=281;	a[1,2]:=302;	a[1,3]:=306;	a[1,4]:=300;	a[1,5]:=283;	a[1,6]:=282;	a[1,7]:=327;	a[1,8]:=328;	a[1,9]:=342;	a[1,10]:=386;	a[1,11]:=387;	a[1,12]:=382;&#13;&#10;a[6,1]:=103;	a[6,2]:=138;	a[6,3]:=149;	a[6,4]:=154;	a[6,5]:=117;	a[6,6]:=129;	a[6,7]:=144;	a[6,8]:=145;	a[6,9]:=152;	a[6,10]:=159;	a[6,11]:=158;	a[6,12]:=156;&#13;&#10;a[2,1]:=143;	a[2,2]:=143;	a[2,3]:=143;	a[2,4]:=143;	a[2,5]:=143;	a[2,6]:=134;	a[2,7]:=134;	a[2,8]:=143;	a[2,9]:=143;	a[2,10]:=160;	a[2,11]:=176;	a[2,12]:=159;&#13;&#10;a[3,1]:=96;	a[3,2]:=147;	a[3,3]:=147;	a[3,4]:=142;	a[3,5]:=124;	a[3,6]:=137;	a[3,7]:=141;	a[3,8]:=201;	a[3,9]:=313;	a[3,10]:=314;	a[3,11]:=314;	a[3,12]:=315;&#13;&#10;a[8,1]:=153;	a[8,2]:=162;	a[8,3]:=168;	a[8,4]:=158;	a[8,5]:=158;	a[8,6]:=164;	a[8,7]:=187;	a[8,8]:=184;	a[8,9]:=181;	a[8,10]:=213;	a[8,11]:=193;	a[8,12]:=183;&#13;&#10;a[7,1]:=322;	a[7,2]:=322;	a[7,3]:=322;	a[7,4]:=322;	a[7,5]:=322;	a[7,6]:=322;	a[7,7]:=322;	a[7,8]:=322;	a[7,9]:=332;	a[7,10]:=369;	a[7,11]:=369;	a[7,12]:=372;&#13;&#10;a[4,1]:=118;	a[4,2]:=118;	a[4,3]:=118;	a[4,4]:=118;	a[4,5]:=118;	a[4,6]:=117;	a[4,7]:=117;	a[4,8]:=118;	a[4,9]:=118;	a[4,10]:=124;	a[4,11]:=124;	a[4,12]:=121;&#13;&#10;a[9,1]:=0;	a[9,2]:=0;	a[9,3]:=0;	a[9,4]:=0;	a[9,5]:=0;	a[9,6]:=0;	a[9,7]:=0;	a[9,8]:=0;	a[9,9]:=73;	a[9,10]:=73;	a[9,11]:=73;	a[9,12]:=74;&#13;&#10;a[0,1]:=1298;	a[0,2]:=1439;	a[0,3]:=1460;	a[0,4]:=1444;	a[0,5]:=1372;	a[0,6]:=1392;	a[0,7]:=1479;	a[0,8]:=1546;	a[0,9]:=1654;	a[0,10]:=1798;	a[0,11]:=1794;	a[0,12]:=1764;&#13;&#10;&#13;&#10;       Memo39.Memo.Text := '[dsData.&#34;PLAN_OMS&#34;]';        &#13;&#10;             &#13;&#10;       m:=MonthOf(dtBegin.Date);&#13;&#10;  &#13;&#10;       case &#60;dsData.&#34;KODOTD&#34;&#62; of&#13;&#10;          &#13;&#10;         2:  if &#60;dsData.&#34;NAIMOTD&#34;&#62; = 'ТЕРАПЕВТИЧЕСКОЕ № 1' then&#13;&#10;               begin&#13;&#10;               Memo39.Memo.Text :=  IntToStr(Round(&#60;dsData.&#34;PLAN_OMS&#34;&#62;*70/130));                   &#13;&#10;               Memo17.Memo.Text :=  IntToStr(Round(a[1,m]*70/130));&#13;&#10;               Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[1,m]*70/130)*100);&#13;&#10;               end                       &#13;&#10;             else if &#60;dsData.&#34;NAIMOTD&#34;&#62; = 'ТЕРАПЕВТИЧЕСКОЕ № 2' then                              &#13;&#10;               begin&#13;&#10;               Memo39.Memo.Text :=  IntToStr(Round(&#60;dsData.&#34;PLAN_OMS&#34;&#62;*60/130));                   &#13;&#10;               Memo17.Memo.Text :=  IntToStr(Round(a[1,m]*60/130));&#13;&#10;               Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[1,m]*60/130)*100);&#13;&#10;               end;  &#13;&#10;         3:  begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(a[2,m]);&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/a[2, m]*100);&#13;&#10;             end;&#13;&#10;         4:  begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(Round(a[3,m]*40/90));&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[3,m]*40/90)*100);&#13;&#10;             end;&#13;&#10;         39: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(Round(a[3,m]*50/90));&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[3,m]*50/90)*100);             &#13;&#10;             end;                 &#13;&#10;         9:  begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(a[4,m]);&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/a[4, m]*100);&#13;&#10;             end;&#13;&#10;         12: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(a[5,m]);&#13;&#10;             if a[5, m] = 0 then &#13;&#10;             Memo19.Memo.Text := '-' else                 &#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/a[5, m]*100);&#13;&#10;             end;&#13;&#10;         22: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(a[6,m]);&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/a[6, m]*100);&#13;&#10;             end;&#13;&#10;         30: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(Round(a[7,m]/2));&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[7,m]/2)*100);&#13;&#10;             end;&#13;&#10;         199: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(Round(a[7,m]/2));&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[7,m]/2)*100);&#13;&#10;             end;                 &#13;&#10;         31: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(Round(a[8,m]/2));&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[8,m]/2)*100);             &#13;&#10;             end;&#13;&#10;         32: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(Round(a[8,m]/2));&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/Round(a[8,m]/2)*100);             &#13;&#10;             end;                 &#13;&#10;         77: begin            &#13;&#10;             Memo17.Memo.Text :=  IntToStr(a[9,m]);&#13;&#10;             Memo19.Memo.Text :=  FormatFloat('0.00', &#60;dsData.&#34;CNT&#34;&#62;/a[9, m]*100);             &#13;&#10;             end;                 &#13;&#10;       end;&#13;&#10;&#13;&#10;       sum := sum + &#60;dsData.&#34;CNT&#34;&#62;;                                 &#13;&#10;        &#13;&#10;       Memo20.Memo.Text :=  IntToStr(a[0, m]);&#13;&#10;       Memo22.Memo.Text :=  FormatFloat('0.00', sum/a[0, m]*100);&#13;&#10;end;  &#13;&#10;&#13;&#10;     &#13;&#10;&#13;&#10;procedure btSubOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btAddOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;  &#13;&#10;  &#13;&#10;&#13;&#10;begin&#13;&#10;  &#13;&#10;end.&#13;&#10;    " StoreInDFM="False" OnReportPrint="frxReportOnReportPrint" PropData="044C656674021003546F7002100844617461736574730101062620446174615365743D226473446174612220446174615365744E616D653D22647344617461220001062420446174615365743D2264734C50552220446174615365744E616D653D2264734C5055220000095661726961626C657301010616204E616D653D22204E65772043617465676F727931220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxFIBQuery Name="dsData" UserName="dsData" CloseDataSource="True" FieldAliases.Text="KODOTD=KODOTD&#13;&#10;NAIMOTD=NAIMOTD&#13;&#10;PLAN_OMS=PLAN_OMS&#13;&#10;CNT=CNT&#13;&#10;KD=KD&#13;&#10;CL=CL" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT KODOTD, NAIMOTD, SUM(PLAN_OMS) as PLAN_OMS, MIN(CNT) as CNT, MIN(KD) as KD, MIN(CL) as CL                  &#13;&#10;FROM&#13;&#10;   (SELECT  -- Замена кодов и наименований отделений, группировка                                                                                                                                                   &#13;&#10;        /*CASE KODOTD&#13;&#10;           WHEN 32  THEN 31  &#13;&#10;          -- WHEN 199 THEN 30&#13;&#10;          -- WHEN 39  THEN 4     &#13;&#10;          -- WHEN 77  THEN 3               &#13;&#10;           ELSE KODOTD&#13;&#10;        END AS KODOTD,           &#13;&#10;                                                                                                                                                                                                         &#13;&#10;        CASE NAIMOTD&#13;&#10;           WHEN 'ТЕРАПЕВТИЧЕСКОЕ № 1' THEN 'ТЕРАПЕВТИЧЕСКОЕ'  &#13;&#10;           WHEN 'ТЕРАПЕВТИЧЕСКОЕ № 2' THEN 'ТЕРАПЕВТИЧЕСКОЕ'&#13;&#10;          -- WHEN 'ОТОЛАРИНГОЛОГИЧЕСКОЕ ДЛЯ ДЕТЕЙ' THEN 'ОТОЛАРИНГОЛОГИЧЕСКОЕ'  &#13;&#10;          -- WHEN 'ОФТАЛЬМОЛОГИЧЕСКОЕ (ЭКСТР.НЕОТ' THEN 'ОФТАЛЬМОЛОГИЧЕСКОЕ'&#13;&#10;          -- WHEN 'ХИРУРГИЧЕСКОЕ ГНОЙНОЕ' THEN 'ХИРУРГИЧЕСКОЕ'&#13;&#10;          -- WHEN 'ГИНЕКОЛОГИЧЕСКОЕ(ЭКСТРЕННОЕ)' THEN 'ГИНЕКОЛОГИЧЕСКОЕ'               &#13;&#10;           ELSE NAIMOTD&#13;&#10;        END AS NAIMOTD,    */            &#13;&#10;          &#13;&#10;        KODOTD,&#13;&#10;        NAIMOTD,              &#13;&#10;        COUNT(*) AS CNT,&#13;&#10;        SUM(KD)  AS KD,&#13;&#10;        SUM(CL)  AS CL&#13;&#10;          &#13;&#10;        FROM ( -- Объединение данных по АК и иногородним                                                                                                          &#13;&#10;             SELECT * FROM RP_FORM4_1(:LPU_ID, :dtStart, :dtStop, :ALL_LPU, 3)&#13;&#10;             UNION ALL                      &#13;&#10;             SELECT * FROM RP_FORM4_1(:LPU_ID, :dtStart, :dtStop, :ALL_LPU, 4)&#13;&#10;             )&#13;&#10;        GROUP BY 1,2                &#13;&#10;   ) AS a       &#13;&#10; LEFT JOIN VW_BED_CLINIC_PLAN AS b&#13;&#10; ON (a.KODOTD=b.SPROTD_ID_FK AND b.y = EXTRACT(YEAR FROM CAST(:dtStart AS DATE)) &#13;&#10;                             AND b.m &#62;= EXTRACT(MONTH FROM CAST(:dtStart AS DATE)) &#13;&#10;                             AND b.m &#60;= EXTRACT(MONTH FROM CAST(:dtStop AS DATE))&#13;&#10;                             AND b.CLINIC_ID_FK=:kodbol)&#13;&#10; GROUP BY NAIMOTD, KODOTD                " PropData="05704C656674025C0470546F7002700A506172616D657465727301010623204E616D653D224C50555F4944222044617461547970653D226674556E6B6E6F776E2200010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D22647453746F70222044617461547970653D226674556E6B6E6F776E2200010624204E616D653D22414C4C5F4C5055222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D224C50555F4944222044617461547970653D226674556E6B6E6F776E2200010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D22647453746F70222044617461547970653D226674556E6B6E6F776E2200010624204E616D653D22414C4C5F4C5055222044617461547970653D226674556E6B6E6F776E2200010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D22647453746F70222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D226B6F64626F6C222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxFIBQuery Name="dsLPU" UserName="dsLPU" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="Select St_bol_name, OGRN From VW_ST_BOL&#13;&#10;Where kodbol=:kodbol                                             " PropData="05704C65667402240470546F7002700A506172616D657465727301010622204E616D653D226B6F64626F6C222044617461547970653D226674537472696E67220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnAfterPrint="Page1OnAfterPrint">
    <TfrxReportTitle Name="ReportTitle1" Height="117,16543" Left="0" Top="16" Width="1046,92981">
      <TfrxMemoView Name="Memo9" Left="0" Top="0" Width="1050,70934" Height="22,67718" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="4" ParentFont="False" Text="[NameMO]"/>
      <TfrxMemoView Name="Memo3" Left="136,06308" Top="22,67718" Width="718,1107" Height="94,48825" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ВЫПОЛНЕНИЕ ПЛАНА&#13;&#10;[PeriodName]&#13;&#10;по Алтайскому краю и другим регионам"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="326" Width="1046,92981">
      <TfrxMemoView Name="Memo120" Left="438,42548" Top="0" Width="102,04731" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="Стр. [Page#] из [TotalPages#]"/>
      <TfrxMemoView Name="Memo121" Left="566,9295" Top="0" Width="321,26005" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Дата и время составления отчета [Date] [Time]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="md" Height="18,89765" Left="0" Top="250" Width="1046,92981" OnAfterCalcHeight="mdOnAfterCalcHeight" OnAfterPrint="mdOnAfterPrint" OnBeforePrint="mdOnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="dsData" DataSetName="dsData" RowCount="0" Stretched="True">
      <TfrxMemoView Name="dsDataDIAG" Left="37,7953" Top="0" Width="287,24404323" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" Text="[dsData.&#34;NAIMOTD&#34;]"/>
      <TfrxMemoView Name="Memo25" Left="325,03958" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="CNT" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[dsData.&#34;CNT&#34;]"/>
      <TfrxMemoView Name="Memo28" Left="400,63018" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="KD" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[dsData.&#34;KD&#34;]"/>
      <TfrxMemoView Name="Memo36" Left="778,58318" Top="0" Width="109,60629677" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" HideZeros="True" ParentFont="False" Text="[dsData.&#34;CL&#34;]"/>
      <TfrxMemoView Name="Memo39" Left="476,22078" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[dsData.&#34;PLAN_OMS&#34;]"/>
      <TfrxMemoView Name="Memo40" Left="551,81138" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[IIF(&#60;dsData.&#34;PLAN_OMS&#34;&#62;=0, '', &#60;dsData.&#34;KD&#34;&#62;/&#60;dsData.&#34;PLAN_OMS&#34;&#62;*100)]"/>
      <TfrxMemoView Name="Memo54" Left="0" Top="0" Width="37,79523898" Height="18,89765" OnBeforePrint="Memo54OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[dsData.&#34;KODOTD&#34;]"/>
      <TfrxMemoView Name="Memo17" Left="627,40198" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo19" Left="702,99258" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text=""/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="75,59055118" Left="0" Top="154" Width="1046,92981">
      <TfrxMemoView Name="Memo14" Left="0" Top="0" Width="325,03934323" Height="37,79527559" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Отделение"/>
      <TfrxMemoView Name="Memo15" Left="325,03958" Top="0" Width="75,59055118" Height="75,59055118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="Выбыло всего "/>
      <TfrxMemoView Name="Memo5" Left="37,7953" Top="37,79527559" Width="287,24404323" Height="37,79527559" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Наименование"/>
      <TfrxMemoView Name="Memo6" Left="0" Top="37,79527559" Width="37,79526339" Height="37,79527559" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Код"/>
      <TfrxMemoView Name="Memo7" Left="400,63018" Top="0" Width="75,59055118" Height="75,59055118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="Количество койко-дней"/>
      <TfrxMemoView Name="Memo11" Left="778,58318" Top="0" Width="109,60629677" Height="75,59055118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="Стоимость &#13;&#10;лечения"/>
      <TfrxMemoView Name="Memo18" Left="476,22078" Top="0" Width="75,59055118" Height="75,59055118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="Койко-дней по плану"/>
      <TfrxMemoView Name="Memo21" Left="551,81138" Top="0" Width="75,59055118" Height="75,59055118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="% выполнения плана по койкодням"/>
      <TfrxMemoView Name="Memo1" Left="627,40198" Top="0" Width="75,59055118" Height="75,59055118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="Пролеченных пациентов по плану"/>
      <TfrxMemoView Name="Memo4" Left="702,99258" Top="0" Width="75,59055118" Height="75,59055118" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" WordBreak="True" VAlign="vaCenter" Text="% выполнения плана по пациентам"/>
    </TfrxPageHeader>
    <TfrxReportSummary Name="ReportSummary1" Height="18,89765" Left="0" Top="288" Width="1046,92981" OnBeforePrint="ReportSummary1OnBeforePrint">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="325,03958" Height="18,89765" ShowHint="False" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" GapX="5" ParentFont="False" Text="Итого по ЛПУ"/>
      <TfrxMemoView Name="Memo8" Left="325,03958" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[SUM(&#60;dsData.&#34;CNT&#34;&#62;,md)]"/>
      <TfrxMemoView Name="Memo10" Left="400,63018" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[SUM(&#60;dsData.&#34;KD&#34;&#62;,md)]"/>
      <TfrxMemoView Name="Memo13" Left="778,58318" Top="0" Width="109,60629677" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" HideZeros="True" ParentFont="False" Text="[SUM(&#60;dsData.&#34;CL&#34;&#62;,md)]"/>
      <TfrxMemoView Name="Memo12" Left="476,22078" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[SUM(&#60;dsData.&#34;PLAN_OMS&#34;&#62;,md)]"/>
      <TfrxMemoView Name="Memo16" Left="551,81138" Top="0" Width="75,59057559" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="dsData" DataSetName="dsData" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" Text="[SUM(&#60;dsData.&#34;KD&#34;&#62;,md)/SUM(&#60;dsData.&#34;PLAN_OMS&#34;&#62;,md)*100]"/>
      <TfrxMemoView Name="Memo20" Left="627,40198" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo22" Left="702,99258" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxReportSummary>
  </TfrxReportPage>
  <TfrxDialogPage Name="fMain" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="186" ClientHeight="158" Left="401" Top="148" Width="341" ClientWidth="333" OnActivate="fMainOnActivate">
    <TfrxLabelControl Name="Label2" Left="12" Top="12" Width="153" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Период формирования отчёта" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="112" Top="118" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Ок" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="228" Top="118" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="24" Top="40" Width="82" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Начало периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtBegin" Left="140" Top="36" Width="85" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40820,4585511227" Time="40820,4585511227"/>
    <TfrxLabelControl Name="Label3" Left="24" Top="68" Width="100" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Окончание периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtEnd" Left="140" Top="64" Width="85" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40820,4594548264" Time="40820,4594548264"/>
    <TfrxCheckBoxControl Name="CheckBox1" Left="22" Top="94" Width="365" Height="17" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Hint="Включать подчиненные участковые больницы и врачебные амбулатории" ShowHint="True" Caption="Учитывать УБ и ВА" Color="-16777201"/>
    <TfrxButtonControl Name="btSub" Left="242" Top="36" Width="23" Height="25" ShowHint="True" Caption="&#60;" OnClick="btSubOnClick"/>
    <TfrxButtonControl Name="btAdd" Left="266" Top="36" Width="23" Height="25" ShowHint="True" Caption="&#62;" OnClick="btAddOnClick"/>
  </TfrxDialogPage>
</TfrxReport>
