<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.8.27" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41597,5000619213" ReportOptions.Description.Text="" ReportOptions.LastChange="41792,663109213" ScriptLanguage="PascalScript" ScriptText.Text="procedure fMainOnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dtBegin.Date := EncodeDate(YearOf(now),MonthOf(now),1);&#13;&#10;  dtEnd.Date := EncodeDate(YearOf(now),MonthOf(now),DaysInMonth(YearOf(now),MonthOf(now)));&#13;&#10;&#13;&#10;  dsOtd.Close;&#13;&#10;  dsOtd.ParamByName('lpu_id').Value := StrToInt(VarIdLPU);&#13;&#10;  dsOtd.Open;&#13;&#10;  dsOtd.Close;&#13;&#10;   &#13;&#10; { dsLPU.Close;&#13;&#10;  dsLPU.ParamByName('kodbol').Value := StrToInt(VarIdLPU);&#13;&#10;  dsLPU.Open;          &#13;&#10;  Set('NameMO',    '''' + dsLPU.FieldByName('st_bol_name').AsString + '''');&#13;&#10;  Set('DIRECTOR',  '''' + dsLPU.FieldByName('DIRECTOR').AsString + '''');          &#13;&#10;  Set('ECONOMIST', '''' + dsLPU.FieldByName('ECONOMIST').AsString + '''');          &#13;&#10;  dsLPU.Close; }  &#13;&#10;  &#13;&#10;  dsContract.Close;&#13;&#10;  dsContract.ParamByName('ID_LPU').Value      := StrToInt(VarIdLPU);&#13;&#10;  dsContract.Open;&#13;&#10;  dsContract.Last;&#13;&#10;  dsContract.First;      &#13;&#10;                                                                                       &#13;&#10;end;  &#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Set('ORGANIZATION',    '''' + dsContract.FieldByName('ORGANIZATION').AsString    + '''');                                                         &#13;&#10;  Set('CONTRACT_NUMBER', '''' + dsContract.FieldByName('CONTRACT_NUMBER').AsString + '''');                                                         &#13;&#10;  Set('Period', '''за период с ' + DateToStr(dtBegin.Date) + ' по ' +DateToStr(dtEnd.Date) + '''');&#13;&#10;  dsReestr2.Close;&#13;&#10;  dsReestr2.ParamByName('ID_LPU').Value      := StrToInt(VarIdLPU);                                                &#13;&#10;  dsReestr2.ParamByName('DATE_BEG').Value    := DateToStr(dtBegin.Date);&#13;&#10;  dsReestr2.ParamByName('DATE_END').Value    := DateToStr(dtEnd.Date);&#13;&#10;  dsReestr2.Open;&#13;&#10;&#13;&#10;  if dsReestr2.RecordCount = 0 then&#13;&#10;      ShowMessage('Нет данных согласно выбранным условиям!')       &#13;&#10;  else      &#13;&#10;    begin            &#13;&#10;      Button1.ModalResult := mrOk;                                        &#13;&#10;      fMain.modalresult   := mrOk;    &#13;&#10;    end;      &#13;&#10;  &#13;&#10;end;  &#13;&#10;&#13;&#10;&#13;&#10; procedure btSubOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btAddOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;&#13;&#10; &#13;&#10;&#13;&#10;     &#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" OnStartReport="rAllOnStartReport" OnReportPrint="frxReportOnReportPrint" PropData="044C656674021003546F7002100844617461736574730101062420446174615365743D2264734C50552220446174615365744E616D653D2264734C5055220001062420446174615365743D2264734F74642220446174615365744E616D653D2264734F7464220001062E20446174615365743D226473436F6E74726163742220446174615365744E616D653D226473436F6E7472616374220001062C20446174615365743D226473526565737472322220446174615365744E616D653D22647352656573747232220000095661726961626C65730101142A000000204E616D653D2220D09FD0B5D180D0B5D0BCD0B5D0BDD0BDD18BD0B520D0BED182D187D0B5D182D0B0220001061A204E616D653D2249445F4C5055222056616C75653D223131382200010624204E616D653D224454424547494E222056616C75653D222730312E30352E32303134272200010622204E616D653D224454454E44222056616C75653D222733302E30352E32303134272200010620204E616D653D22434F4E54524143545F49445F464B222056616C75653D2236220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxFIBQuery Name="dsLPU" UserName="dsLPU" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT ST_BOL_NAME, OGRN,&#13;&#10;       LEFT(FNAME_DIRECTOR,1)  || '.' || LEFT(MNAME_DIRECTOR,1)  || '.' || LNAME_DIRECTOR  AS DIRECTOR,&#13;&#10;       LEFT(FNAME_ECONOMIST,1) || '.' || LEFT(MNAME_ECONOMIST,1) || '.' || LNAME_ECONOMIST AS ECONOMIST&#13;&#10;  FROM VW_ST_BOL&#13;&#10; WHERE kodbol = :kodbol&#13;&#10;                                             " PropData="05704C65667402480470546F7002500A506172616D657465727301010622204E616D653D226B6F64626F6C222044617461547970653D226674537472696E67220000"/>
    <TfrxFIBQuery Name="dsOtd" UserName="dsOtd" CloseDataSource="True" FieldAliases.Text="KODOTD=KODOTD&#13;&#10;OTD_NUM=OTD_NUM&#13;&#10;KOD_NUM=KOD_NUM&#13;&#10;NAIMOTD=NAIMOTD&#13;&#10;VIDSTAC=VIDSTAC&#13;&#10;FULLNAME=FULLNAME" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT *&#13;&#10;  FROM multy_otd(:lpu_id)&#13;&#10; ORDER BY naimotd&#13;&#10;    " PropData="05704C6566740380000470546F7002500A506172616D657465727301010623204E616D653D226C70755F6964222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxFIBQuery Name="dsContract" UserName="dsContract" CloseDataSource="True" FieldAliases.Text="CONTRACT_ID=CONTRACT_ID&#13;&#10;CONTRACT_NAME=CONTRACT_NAME&#13;&#10;ID_LPU_FK=ID_LPU_FK&#13;&#10;LPU_NAME=LPU_NAME&#13;&#10;BEGIN_DATE=BEGIN_DATE&#13;&#10;END_DATE=END_DATE&#13;&#10;CONTRACT_NUMBER=CONTRACT_NUMBER&#13;&#10;ORGANIZATION=ORGANIZATION&#13;&#10;UTV_DOLJ=UTV_DOLJ&#13;&#10;UTV_FIO=UTV_FIO&#13;&#10;COMMENTS=COMMENTS&#13;&#10;COST=COST&#13;&#10;PS_INN=PS_INN&#13;&#10;PS_KPP=PS_KPP" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT *&#13;&#10;  FROM vw_contracts con&#13;&#10; WHERE con.id_lpu_fk   = :ID_LPU&#13;&#10;   --AND con.contract_id = :CONTRACT_ID&#13;&#10;                 " PropData="05704C65667403BC000470546F7002500A506172616D657465727301010623204E616D653D2249445F4C5055222044617461547970653D226674556E6B6E6F776E2200010628204E616D653D22434F4E54524143545F4944222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxFIBQuery Name="dsReestr2" UserName="dsReestr2" CloseDataSource="True" FieldAliases.Text="KOD_NUM=KOD_NUM&#13;&#10;NAIMOTD=NAIMOTD&#13;&#10;KD=KD&#13;&#10;COUNT=COUNT" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="   SELECT pm.sprotd_id_fk * 10 + COALESCE(pm.otd_num, 0) AS KOD_NUM,&#13;&#10;          otd.naimotd || COALESCE(' № ' || CAST(pm.otd_num AS VARCHAR(2)), '') AS NAIMOTD,&#13;&#10;          SUM(pm.kd) AS KD,  &#13;&#10;          COUNT(*)                          &#13;&#10;        --  pm.contract_id_fk                        &#13;&#10;     FROM wt_patient     pat&#13;&#10;     JOIN wt_patient_move pm ON pm.wt_patient_id_fk = pat.wt_patient_id&#13;&#10;     JOIN vw_st_sprotd   otd ON otd.kodotd          = pm.sprotd_id_fk&#13;&#10;     JOIN vw_st_bol      bol ON bol.kodbol          = pat.id_lpu_fk&#13;&#10;    WHERE pat.dtextract BETWEEN :DATE_BEG AND :DATE_END&#13;&#10;      AND pm.contract_id_fk IN (SELECT con.contract_id&#13;&#10;                                FROM vw_contracts AS con&#13;&#10;                                WHERE con.id_lpu_fk   = :ID_LPU)         &#13;&#10;      AND bol.key3          = :ID_LPU&#13;&#10;      AND pm.cl_otd         &#62; 0&#13;&#10;    GROUP BY 1,2                                                 &#13;&#10;    ORDER BY kod_num    " PropData="05704C6566740344010470546F7002500A506172616D657465727301010625204E616D653D22444154455F424547222044617461547970653D226674556E6B6E6F776E2200010625204E616D653D22444154455F454E44222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D2249445F4C5055222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D2249445F4C5055222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData3" Height="18,89765" Left="0" Top="192,75603" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="dsReestr2" DataSetName="dsReestr2" RowCount="0">
      <TfrxMemoView Name="dsReestr2NAIMOTD" Left="83,14966" Top="0" Width="396,85065" Height="18,89765" ShowHint="False" DataField="NAIMOTD" DataSet="dsReestr2" DataSetName="dsReestr2" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="10" ParentFont="False" Text="[dsReestr2.&#34;NAIMOTD&#34;]"/>
      <TfrxMemoView Name="dsReestr2KD" Left="559,37044" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" DataField="KD" DataSet="dsReestr2" DataSetName="dsReestr2" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[dsReestr2.&#34;KD&#34;]"/>
      <TfrxMemoView Name="dsReestr2COUNT" Left="480,00031" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" DataField="COUNT" DataSet="dsReestr2" DataSetName="dsReestr2" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[dsReestr2.&#34;COUNT&#34;]"/>
    </TfrxMasterData>
    <TfrxFooter Name="Footer1" Height="18,89765" Left="0" Top="234,33086" Width="718,1107">
      <TfrxMemoView Name="Memo2" Left="480,00031" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" Color="-16777194" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;dsReestr2.&#34;COUNT&#34;&#62;,MasterData3)]"/>
      <TfrxMemoView Name="Memo3" Left="559,37044" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" Color="-16777194" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;dsReestr2.&#34;KD&#34;&#62;,MasterData3)]"/>
      <TfrxMemoView Name="Memo4" Left="83,14966" Top="0" Width="396,85065" Height="18,89765" ShowHint="False" Color="-16777194" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="Всего &#13;&#10; "/>
    </TfrxFooter>
    <TfrxReportTitle Name="ReportTitle1" Height="71,81107" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo8" Left="0" Top="0" Width="718,1107" Height="49,13389" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="СВЕДЕНИЯ О ПРОЛЕЧЕННЫХ&#13;&#10;ПО ПЛАТНЫМ ДОГОВОРАМ"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="49,13389" Width="721,89023" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Period]"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="313,70099" Width="718,1107">
      <TfrxMemoView Name="Memo121" Left="389,29159" Top="0" Width="328,81911" Height="22,67718" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Дата и время составления отчета [Date] [Time]"/>
    </TfrxPageFooter>
    <TfrxHeader Name="Header1" Height="18,89765" Left="0" Top="151,1812" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="83,14966" Top="0" Width="396,85065" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Отделение"/>
      <TfrxMemoView Name="Memo5" Left="480,00031" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Человек"/>
      <TfrxMemoView Name="Memo6" Left="559,37044" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="К/дн"/>
    </TfrxHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="fMain" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="158" ClientHeight="125" Left="465" Top="191" Width="311" ClientWidth="303" OnActivate="fMainOnActivate">
    <TfrxButtonControl Name="Button1" Left="44" Top="84" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Ок" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="152" Top="84" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="10" Top="20" Width="109" Height="16" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Начало периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtBegin" Left="152" Top="16" Width="91" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="41640,4585511227" Time="41640,4585511227"/>
    <TfrxLabelControl Name="Label3" Left="10" Top="48" Width="132" Height="16" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Окончание периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtEnd" Left="152" Top="44" Width="91" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="41670,4594548264" Time="41670,4594548264"/>
    <TfrxButtonControl Name="btSub" Left="246" Top="16" Width="23" Height="25" ShowHint="True" Caption="&#60;" OnClick="btSubOnClick"/>
    <TfrxButtonControl Name="btAdd" Left="270" Top="16" Width="23" Height="25" ShowHint="True" Caption="&#62;" OnClick="btAddOnClick"/>
  </TfrxDialogPage>
</TfrxReport>
