<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.8.27" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41949,5869153472" ReportOptions.Description.Text="" ReportOptions.LastChange="41949,6222594676" ScriptLanguage="PascalScript" ScriptText.Text="procedure fMainOnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dtBegin.Date := EncodeDate(YearOf(now),MonthOf(now),1);&#13;&#10;  dtEnd.Date := EncodeDate(YearOf(now),MonthOf(now),DaysInMonth(YearOf(now),MonthOf(now)));&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure btSubOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M - 1;&#13;&#10;  if M = 0 then&#13;&#10;  begin&#13;&#10;    Y := Y - 1;&#13;&#10;    M := 12;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btAddOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D, M, Y: word;&#13;&#10;  LastDay: boolean;&#13;&#10;begin&#13;&#10;  DecodeDate(dtBegin.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtBegin.Date := EncodeDate(Y,M,D);&#13;&#10;&#13;&#10;  DecodeDate(dtEnd.Date,Y,M,D);&#13;&#10;  LastDay := (D=DaysInMonth(Y,M));&#13;&#10;  M := M + 1;&#13;&#10;  if M = 13 then&#13;&#10;  begin&#13;&#10;    Y := Y + 1;&#13;&#10;    M := 1;&#13;&#10;  end;&#13;&#10;  if LastDay then&#13;&#10;    D := DaysInMonth(Y,M)&#13;&#10;  else&#13;&#10;  if D&#62;DaysInMonth(Y,M) then&#13;&#10;    D := DaysInMonth(Y,M);&#13;&#10;  dtEnd.Date := EncodeDate(Y,M,D);&#13;&#10;end;  &#13;&#10;&#13;&#10;  &#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;         &#13;&#10;       dsData.Close;&#13;&#10;       dsData.parambyname('lpu_id').Value := StrToInt(VarIdLPU);           &#13;&#10;       dsData.ParamByName('dtStart').Value    := DateToStr(dtBegin.Date);            &#13;&#10;       dsData.ParamByName('dtStop').Value     := DateToStr(dtEnd.Date);&#13;&#10;       dsData.Open;&#13;&#10;     &#13;&#10;    &#13;&#10;&#13;&#10;       Button1.ModalResult := mrOk;                                                                                &#13;&#10;       fMain.modalresult   := mrOk;   &#13;&#10;  &#13;&#10;         &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" OnReportPrint="frxReportOnReportPrint" PropData="044C656674021003546F7002100844617461736574730101062620446174615365743D226473446174612220446174615365744E616D653D22647344617461220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Font.Charset="1" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxFIBQuery Name="dsData" UserName="dsData" CloseDataSource="True" FieldAliases.Text="WT_PATIENT_ID=WT_PATIENT_ID&#13;&#10;NUMCARD=NUMCARD&#13;&#10;ID_LPU_FK=ID_LPU_FK&#13;&#10;LPU_NAME_CARD=LPU_NAME_CARD&#13;&#10;MCOD=MCOD&#13;&#10;PEOPLE_ID_FK=PEOPLE_ID_FK&#13;&#10;LNAME=LNAME&#13;&#10;FNAME=FNAME&#13;&#10;MNAME=MNAME&#13;&#10;PATIENT_FIO=PATIENT_FIO&#13;&#10;BIRTHDAY=BIRTHDAY&#13;&#10;SEX=SEX&#13;&#10;STR_PENS=STR_PENS&#13;&#10;SPRTERR_ID_FK=SPRTERR_ID_FK&#13;&#10;SPRTERR_NAME=SPRTERR_NAME&#13;&#10;CITY_VILLAGE=CITY_VILLAGE&#13;&#10;ADR_REG=ADR_REG&#13;&#10;ADR_FAKT=ADR_FAKT&#13;&#10;SPRDOC_ID_FK=SPRDOC_ID_FK&#13;&#10;DOCNAME=DOCNAME&#13;&#10;SERDOC=SERDOC&#13;&#10;NUMDOC=NUMDOC&#13;&#10;DOCUMENT_WHO=DOCUMENT_WHO&#13;&#10;DOCUMENT_WHEN=DOCUMENT_WHEN&#13;&#10;SERPOL=SERPOL&#13;&#10;NUMPOL=NUMPOL&#13;&#10;SPRPLAT_ID_FK=SPRPLAT_ID_FK&#13;&#10;NAIMPLAT=NAIMPLAT&#13;&#10;TERRKOD=TERRKOD&#13;&#10;KOD_SMO_ID_FK=KOD_SMO_ID_FK&#13;&#10;NAIMSMO=NAIMSMO&#13;&#10;PAYMENT=PAYMENT&#13;&#10;SPRSOC_ID_FK=SPRSOC_ID_FK&#13;&#10;NAIMSOC=NAIMSOC&#13;&#10;SPRLGOT_ID_FK=SPRLGOT_ID_FK&#13;&#10;NAIMLGOT=NAIMLGOT&#13;&#10;DIRECT_LPU_ID_FK=DIRECT_LPU_ID_FK&#13;&#10;DIRECT_LPU_NAME=DIRECT_LPU_NAME&#13;&#10;DIRECT_MCOD=DIRECT_MCOD&#13;&#10;DIRECT_LPU_NUMDIRECT=DIRECT_LPU_NUMDIRECT&#13;&#10;DIRECT_LPU_DTDIRECT=DIRECT_LPU_DTDIRECT&#13;&#10;SPRDOST_ID_FK=SPRDOST_ID_FK&#13;&#10;NAIMDOST=NAIMDOST&#13;&#10;DOSTAV_NUM=DOSTAV_NUM&#13;&#10;DIAG_DIRECT_LPU=DIAG_DIRECT_LPU&#13;&#10;DIAG_DIRECT_NAME=DIAG_DIRECT_NAME&#13;&#10;DIAG_PO=DIAG_PO&#13;&#10;DIAG_PO_NAME=DIAG_PO_NAME&#13;&#10;NARK_ID=NARK_ID&#13;&#10;HOSP_ID=HOSP_ID&#13;&#10;HOSP_DANZAB=HOSP_DANZAB&#13;&#10;HOSP_EXTRPOK=HOSP_EXTRPOK&#13;&#10;TIMETRAVMA=TIMETRAVMA&#13;&#10;TRAVMA=TRAVMA&#13;&#10;DT_RECEIPT=DT_RECEIPT&#13;&#10;TM_RECEIPT=TM_RECEIPT&#13;&#10;BRANCH_ID_FK=BRANCH_ID_FK&#13;&#10;KOD_NUM=KOD_NUM&#13;&#10;NAIMOTD=NAIMOTD&#13;&#10;DT_BRANCH=DT_BRANCH&#13;&#10;TM_BRANCH=TM_BRANCH&#13;&#10;DOCTOR_ID_FK=DOCTOR_ID_FK&#13;&#10;NAIMDOC=NAIMDOC&#13;&#10;DTEXTRACT=DTEXTRACT&#13;&#10;TMEXTRACT=TMEXTRACT&#13;&#10;DURATION_HOSP=DURATION_HOSP&#13;&#10;OUTCOME_HOSP=OUTCOME_HOSP&#13;&#10;RESULT_HOSP=RESULT_HOSP&#13;&#10;ISHOD=ISHOD&#13;&#10;DTBEGIN_SL=DTBEGIN_SL&#13;&#10;DTEND_SL=DTEND_SL&#13;&#10;SL_LEAVING=SL_LEAVING&#13;&#10;LEAV_FULLYEAR=LEAV_FULLYEAR&#13;&#10;LEAV_SEX=LEAV_SEX&#13;&#10;SURV_RW=SURV_RW&#13;&#10;SURV_AIDS=SURV_AIDS&#13;&#10;CLINIC_DIAG=CLINIC_DIAG&#13;&#10;CLINIC_COMPLICATION=CLINIC_COMPLICATION&#13;&#10;CLINIC_COMPLICATIONS=CLINIC_COMPLICATIONS&#13;&#10;CLINIC_ACCOMPDIAG=CLINIC_ACCOMPDIAG&#13;&#10;CLINIC_ACCOMPDIAGS=CLINIC_ACCOMPDIAGS&#13;&#10;PATOLOG_DIAG=PATOLOG_DIAG&#13;&#10;PATOLOG_COMPLICATION=PATOLOG_COMPLICATION&#13;&#10;PATOLOG_ACCOMPDIAG=PATOLOG_ACCOMPDIAG&#13;&#10;CLINIC_DIAG_NAME=CLINIC_DIAG_NAME&#13;&#10;CLINIC_COMPLICATION_NAME=CLINIC_COMPLICATION_NAME&#13;&#10;CLINIC_ACCOMPDIAG_NAME=CLINIC_ACCOMPDIAG_NAME&#13;&#10;PATOLOG_DIAG_NAME=PATOLOG_DIAG_NAME&#13;&#10;PATOLOG_COMPLICATION_NAME=PATOLOG_COMPLICATION_NAME&#13;&#10;PATOLOG_ACCOMPDIAG_NAME=PATOLOG_ACCOMPDIAG_NAME&#13;&#10;DEATH_MKB=DEATH_MKB&#13;&#10;DEATH_MKB_NAME=DEATH_MKB_NAME&#13;&#10;DEFECTS_PREHOSP=DEFECTS_PREHOSP" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select * from&#13;&#10;       VW_PATIENT_CARD as pat             &#13;&#10;WHERE dtextract BETWEEN :dtStart AND :dtStop&#13;&#10;AND ID_LPU_FK = :lpu_id&#13;&#10;--AND KOD_NUM = :otd&#13;&#10;AND CLINIC_DIAG IS NULL                                                   &#13;&#10;ORDER BY NAIMOTD, PATIENT_FIO                                                " PropData="05704C65667402680470546F7002460A506172616D657465727301010624204E616D653D2264745374617274222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D22647453746F70222044617461547970653D226674556E6B6E6F776E2200010623204E616D653D226C70755F6964222044617461547970653D226674556E6B6E6F776E2200010620204E616D653D226F7464222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="56,69295" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo2" Left="75,5906" Top="3,77953" Width="551,81138" Height="49,13389" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-21" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="Пациенты с не указанным клиническим заключительным диагнозом"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="298,58287" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData2" Height="18,89765" Left="0" Top="219,21274" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="dsData" DataSetName="dsData" RowCount="0">
      <TfrxMemoView Name="dsDataPATIENT_FIO" Left="154,96073" Top="0" Width="563,14997" Height="18,89765" ShowHint="False" DataField="PATIENT_FIO" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[dsData.&#34;PATIENT_FIO&#34;]"/>
      <TfrxMemoView Name="dsDataNUMCARD" Left="0" Top="0" Width="68,03154" Height="18,89765" ShowHint="False" DataField="NUMCARD" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[dsData.&#34;NUMCARD&#34;]"/>
      <TfrxMemoView Name="dsDataDTEXTRACT" Left="68,03154" Top="0" Width="86,92919" Height="18,89765" ShowHint="False" DataField="DTEXTRACT" DataSet="dsData" DataSetName="dsData" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[dsData.&#34;DTEXTRACT&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header2" Height="18,89765" Left="0" Top="177,63791" Width="718,1107">
      <TfrxMemoView Name="Memo31" Left="0" Top="0" Width="68,03154" Height="18,89765" ShowHint="False" DataSetName="dsWithoutResult" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="№ карты"/>
      <TfrxMemoView Name="Memo33" Left="154,96073" Top="0" Width="563,14997" Height="18,89765" ShowHint="False" DataSetName="dsWithoutResult" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="ФИО"/>
      <TfrxMemoView Name="Memo34" Left="68,03154" Top="0" Width="86,92919" Height="18,89765" ShowHint="False" DataSetName="dsWithoutResult" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Дата выбыт."/>
    </TfrxHeader>
    <TfrxGroupHeader Name="GroupHeader1" Height="18,89765" Left="0" Top="136,06308" Width="718,1107" Condition="dsData.&#34;NAIMOTD&#34;">
      <TfrxMemoView Name="dsNAIMOTD" Left="0" Top="0" Width="718,1107" Height="18,89765" ShowHint="False" Color="-16777189" DataSetName="dsWithoutResult" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[dsData.&#34;NAIMOTD&#34;]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="fMain" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="161" ClientHeight="133" Left="378" Top="138" Width="318" ClientWidth="310" OnActivate="fMainOnActivate">
    <TfrxLabelControl Name="Label2" Left="6" Top="2" Width="153" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Период формирования отчёта" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="52" Top="98" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Ок" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="160" Top="98" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="14" Top="30" Width="82" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Начало периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtBegin" Left="158" Top="24" Width="91" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="41640,4585511227" Time="41640,4585511227"/>
    <TfrxLabelControl Name="Label3" Left="14" Top="58" Width="100" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Окончание периода" Color="-16777201"/>
    <TfrxDateEditControl Name="dtEnd" Left="158" Top="52" Width="91" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="42004,4594548264" Time="42004,4594548264"/>
    <TfrxButtonControl Name="btSub" Left="254" Top="24" Width="23" Height="25" ShowHint="True" Caption="&#60;" OnClick="btSubOnClick"/>
    <TfrxButtonControl Name="btAdd" Left="276" Top="24" Width="23" Height="25" ShowHint="True" Caption="&#62;" OnClick="btAddOnClick"/>
  </TfrxDialogPage>
</TfrxReport>
